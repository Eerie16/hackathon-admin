{% extends 'base.html' %}

{% block content %}
    <h1 class="h3 mb-2 text-gray-800">Select region on map</h1>
    <div id="map" style="height: 400px"></div>
    <div id="formdiv">
        <form action="" method="POST" id="form">
            {% csrf_token %}
            <div class="form-row">
                <input type="submit" class="btn btn-primary mt-4 pt-2 pb-2 pl-4 pr-4 mx-auto" value="Submit">
            </div>
        </form>
    </div>
    <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6us9ytBvAiZqk5kxggIWhv4kk0PYcMTk">
    </script>
    <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous">
    </script>
    <script>
      // This example adds a user-editable rectangle to the map.
        var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 29.865, lng: 77.895},
            zoom: 16
        });
        var bounds = {
          north: 29.866,
          south: 29.864,
          east: 77.896,
          west: 77.894
        };

        const customStyles = [
          {
            featureType: "all",
            elementType: "labels",
            stylers: [
              { visibility: "off" }
            ]
          }
        ];
        map.set('styles',customStyles);

        // Define a rectangle and set its editable property to true.
        var rectangle = new google.maps.Rectangle({
          bounds: bounds,
          editable: true,
          draggable: true
        });
        rectangle.setMap(map);
    </script>
    <script>
        {#$("#form").submit(function(e){#}
        {#    e.preventDefault();#}
        {#    var newbounds = rectangle.getBounds();#}
        {#    $.ajax({#}
        {#        url:window.location.toString(),#}
        {#        method:"POST",#}
        {#        data:{#}
        {#            bottom:newbounds.getSouthWest().lat(),#}
        {#            top: newbounds.getNorthEast().lat(),#}
        {#            left: newbounds.getSouthWest().lng(),#}
        {#            right: newbounds.getNorthEast().lng()#}
        {#            },#}
        {#        success:function(data, status, xhr){#}
        {#            console.log(data);#}
        {#        },#}
        {#        error:function(xhr, status, error){#}
        {#            console.log(error);#}
        {#        }#}
        {#    })#}
        {#})#}
    </script>
{% endblock %}